define("main/modules/utils/dev",[],function(){"use strict";return{log:function(){"object"==typeof window.console&&window.console.log(Array.prototype.slice.call(arguments))}}}),define("main/modules/utils/number",["jquery","underscore"],function(a,b){"use strict";return{parseDecimalInt:function(a){return parseInt(a,10)},numberFormat:function(a,b,c,d){if(isNaN(a)||null===a)return"";a=a.toFixed(b),d="string"==typeof d?d:",";var e=a.split("."),f=e[0],g=e[1]?(c||".")+e[1]:"";return f.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+d)+g},formatPrice:function(a,c){b.extend({decimals:2,decimalSeparator:",",orderSeparator:" "},c);var d=this.numberFormat(a,c.decimals,c.decimalSeparator,c.orderSeparator);return d+" "+c.currency}}}),define("main/modules/utils/visual",["jquery","underscore"],function(a,b){"use strict";return{newHelpActivatedCountries:["allegro.pl","vatera.hu","aukro.ua","molotok.ru","aukro.cz"],newHelpUrls:{"allegro.pl":"pomoc.allegro.pl","vatera.hu":"segitseg.vatera.hu","aukro.ua":"help.aukro.ua","molotok.ru":"help.molotok.ru","aukro.cz":"napoveda.aukro.cz"},canShowExternalHelp:function(){return b.contains(this.newHelpActivatedCountries,this.getDomainName())},openHelp:function(a){if(this.canShowExternalHelp())void 0!==a?window.open("http://"+this.newHelpUrls[this.getDomainName()]+"/help_item/"+a,"_blank"):window.open("http://"+this.newHelpUrls[this.getDomainName()],"_blank");else{var b,c="height=400,width=450,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,directories=no,status=no";b=void 0!==a?window.open("/help_item.php?item="+a,"anew",c):window.open("/help.php?","anew",c),b.closed||b.focus()}},scrollTo:function(b,c,d){a("html, body").animate({scrollTop:a(b).offset().top+(d||0)},c||500)},getDomainName:function(){var b=a("body").attr("class").split(" ");return b[0].replace("-",".")}}}),define("main/utils",["main/modules/utils/dev","main/modules/utils/number","main/modules/utils/visual"],function(a,b,c){"use strict";return{dev:a,number:b,visual:c}}),define("velalayout/openHelp",["jquery","main/utils"],function(a,b){"use strict";return{initialize:function(){a("a.open-help").on("click",function(c){var d;void 0!==a(this).data("help-item")&&(d=a(this).data("help-item")),b.visual.openHelp(d),c.preventDefault()})}}}),define("search/auto-complete/models/history",["backbone"],function(a){"use strict";var b=a.Model.extend({initialize:function(){this.set("id",this.cid),this.set("text",this.mask(this.get("text")))},defaults:{phrase:"",text:"",type:3,match:!1},mask:function(a){return a.replace(/^\s+|\s+$/g,"").replace(/\s\s+/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;")}});return b}),define("search/auto-complete/collections/history",["jquery","backbone","underscore","search/auto-complete/models/history"],function(a,b,c,d){"use strict";var e=b.Collection.extend({model:d,initialize:function(a,b){this.config=b,this.history=this.load(),this.queryValue="",this.on("reset",this.dataReceived,this),this.on("add",this.sync,this),this.on("remove",this.sync,this)},dataReceived:function(){this.trigger("dataReceived",{historyReceived:!0})},add:function(a,e){a=a instanceof Array?a:[a],c.each(a,function(a){a=a instanceof b.Model?a:new d(a),""!==a.get("text")&&(this.each(function(b){b.get("text")===a.get("text")&&this.remove(b,{silent:!0})},this),b.Collection.prototype.add.call(this,a,e))},this)},sync:function(){this.history=[],this.each(function(a,b){this.history[this.history.length]=a.get("text")},this),window.localStorage.setItem(this.config.storage,this.history.length?JSON.stringify(this.history):"[]")},load:function(){var b=[];return window.localStorage.getItem(this.config.storage)&&(b=a.parseJSON(window.localStorage.getItem(this.config.storage))),b},parseHistory:function(){var a=this.queryValue,b=[];return a=a.replace(/ /g,"</strong> <strong>"),c.each(this.history,function(c,e){var f,g=this.queryRegExp(this.queryValue),h=(" "+c).replace(g," <strong>"+a+"</strong>").substr(1),i=(" "+c).match(g)?!0:!1;f=new d({phrase:h,text:c,match:i}),b[b.length]=f},this),b[0]?b:[]},query:function(a){this.queryValue=a,this.reset(this.parseHistory())},queryRegExp:function(a){return a=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),new RegExp("\\s"+a,"gi")}});return e}),define("search/auto-complete/collections/suggestions",["jquery","backbone","underscore"],function(a,b,c){"use strict";var d=b.Collection.extend({initialize:function(a,b){this.config=b,this.queryValue="",this.on("reset",this.dataReceived,this)},dataReceived:function(){this.trigger("dataReceived",{suggestionsReceived:!0})},parse:function(b){var d=[];return c.each(b,function(b,c){d[d.length]=a.parseJSON(b)}),d[0]?d:[]},query:function(a){this.queryValue!==a?(this.queryValue=a,this.url=this.config.url+"?q="+a,this.fetch({reset:!0})):this.trigger("reset")}});return d}),define("search/auto-complete/collections/auto-complete",["jquery","backbone","underscore","search/auto-complete/collections/history","search/auto-complete/collections/suggestions"],function(a,b,c,d,e){"use strict";var f=b.Collection.extend({initialize:function(a,b){this.init=!0,this.historyReceived=!1,this.suggestionsReceived=!1,this.config=b,this.queryValue="",this.history=new d([],{storage:b.storage}),this.suggestions=new e([],{url:b.url}),this.history.on("dataReceived",this.dataReceived,this),this.suggestions.on("dataReceived",this.dataReceived,this)},addItem:function(a,b){this.history.add(a,b)},removeItem:function(a){this.history.remove(a),this.trigger("removeItem")},query:function(a){a=this.trim(a),this.history.query(a),this.suggestions.query(a)},dataReceived:function(a){a.historyReceived&&(this.historyReceived=!0),a.suggestionsReceived&&(this.suggestionsReceived=!0),this.historyReceived&&this.suggestionsReceived&&(this.merge(),this.historyReceived=!1,this.suggestionsReceived=!1)},merge:function(){var a,b=[],d=[],e=[];this.history.each(function(a){a.get("match")&&(b[b.length]=a.toJSON(),e[e.length]=a.get("phrase"))}),this.suggestions.each(function(a){var b=c.indexOf(e,a.get("phrase"))>-1&&1===a.get("type"),f=c.indexOf(e,a.get("phrase"))>=this.config.historyMatchLimit;(!b||f)&&(d[d.length]=a.toJSON())},this),a=Math.max(this.config.historyMatchLimit,this.config.totalMatchLimit-d.length),b=b.slice(0,a),d=d.slice(0,this.config.totalMatchLimit-b.length),this.reset(b.concat(d)),this.init&&(this.trigger("hide"),this.init=!1)},trim:function(a){return a=a.replace(/^\s+|\s+$/g,""),a=a.replace(/\s\s+/g," ")}});return f}),define("search/auto-complete/views/auto-complete",["jquery","backbone","underscore"],function(a,b,c){"use strict";var d,e=2,f={ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,LEFT_CMD:91};return d=b.View.extend({events:{"mouseover .auto-complete-list li":"mouseOverResult","mousedown .auto-complete-list li":"clickOnSuggest",'focus input[type="text"]':"clear",'keydown input[type="text"]':"keyDown",'keyup input[type="text"]':"keyUp"},initialize:function(){this.$input=this.$el.find('input[type="text"]'),this.$list=this.$el.find(".auto-complete-list"),this.isHidden=!0,this.timeout=0,this.suggestTemplates={"type-1":c.template(a(this.options.defaultSuggestionTplId).html()),"type-2":c.template(a(this.options.inCategorySuggestionTplId).html()),"type-3":c.template(a(this.options.inHistorySuggestionTplId).html())},this.collection.on("reset",this.dataReceived,this),this.collection.on("hide",this.hide,this),this.collection.on("removeItem",this.query,this),this.query()},keyDown:function(a){switch(a.keyCode){case f.DOWN_ARROW:case f.UP_ARROW:this.move(a);break;case f.ENTER:this.search(a)}},keyUp:function(b){switch(b.keyCode){case f.LEFT_CMD:case f.DOWN_ARROW:case f.RIGHT_ARROW:case f.UP_ARROW:case f.LEFT_ARROW:case f.SHIFT:case f.CTRL:case f.ALT:case f.ENTER:break;case f.ESCAPE:this.hide();break;default:this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(a.proxy(this.query,this),this.options.delay)}b.stopPropagation(),b.preventDefault()},move:function(a){switch(a.keyCode){case f.DOWN_ARROW:a.preventDefault(),this.next();break;case f.UP_ARROW:a.preventDefault(),this.prev()}a.stopPropagation()},next:function(){if(!this.$list.children().length)return this.show(),void this.query();if(this.isHidden)return void this.show();var b=this.$list.find("li.active").removeClass("active"),c=b.next();c.length||(this.show(),c=a(this.$list.find("li")[0])),this.$input.val(c.find(".phrase").text()),c.addClass("active")},prev:function(){if(this.$list.children().length&&!this.isHidden){var b=a("li.active",this.$list).removeClass("active"),c=b.prev();c.length||(c=this.$list.find("li").last()),this.$input.val(c.find(".phrase").text()),c.addClass("active")}},mouseOverResult:function(b){this.$list.find("li.active").removeClass("active"),a(b.currentTarget).addClass("active")},clickOnSuggest:function(b){var c=a(b.currentTarget);this.$input.val(c.find(".phrase").text()),this.search(b)},selectSearchType:function(){var a=this.$list.find("li.active");a.data("type")===e&&(this.$('select[name="search_scope"] option:selected').val().indexOf("userItems-")>=0?this.trigger("request-search-param-add",{name:"id",value:a.data("category")}):this.trigger("request-search-type-change",{type:"category",id:a.data("category")}))},search:function(a){a.preventDefault(),this.selectSearchType(),this.$el.find('input[type="submit"]').trigger("click"),this.hide()},query:function(){this.collection.query(this.$input.val())},clear:function(){this.$list.html(),this.hide()},dataReceived:function(){this.isHidden&&this.show(),this.render()},show:function(){this.trigger("show"),this.isHidden=!1},hide:function(){this.trigger("hide"),this.isHidden=!0},render:function(){var a,b,c="";this.collection.length&&(this.collection.each(function(d){d.get("match")!==!1&&(a="type-"+d.get("type"),b=this.suggestTemplates[a],c+=b(d.toJSON()))},this),c="<ul>"+c+"</ul>"),this.$list.html(c)}})}),define("search/auto-complete/views/history",["jquery","backbone","underscore","search/auto-complete/models/history"],function(a,b,c,d){"use strict";var e=b.View.extend({events:{"mousedown .auto-complete-list li .remove":"removeItem","click .auto-complete-list li .remove":"preventDefault",'click input[type="submit"]':"addItem"},initialize:function(){this.$input=this.$el.find('input[type="text"]')},addItem:function(a){this.collection.addItem(new d({text:this.$input.val()}),{at:0})},removeItem:function(b){this.preventDefault(b),b.stopPropagation(),a(b.currentTarget).parent("li").fadeOut(300,a.proxy(function(){this.collection.removeItem(a(b.currentTarget).data("id"))},this))},preventDefault:function(a){a.preventDefault()}});return e}),define("search/auto-complete/app",["search/auto-complete/collections/auto-complete","search/auto-complete/views/auto-complete","search/auto-complete/views/history"],function(a,b,c){"use strict";return function(d){var e,f,g;return e=new a([],d),d.collection=e,f=new b(d),g=new c(d),f}}),define("search/search-form",["jquery","backbone","search/auto-complete/app"],function(a,b,c){"use strict";b.$=a;var d=b.View.extend({currentCategory:null,events:{"click div.search-type-select strong":"toggleSearchType","click div.search-type-select ul a":"selectSearchType",'blur input[type="text"]':"blur",'click input[type="text"]':"setFormAsActive","mousedown .in-description":"inDescriptionToggle","change .in-description input":"inDescriptionToggle",submit:"validate",click:"stopPropagation"},initialize:function(a){this.$input=this.$el.find('input[type="text"]'),this.$searchType=this.$el.find("div.search-type-select"),this.autoComplete=c(a.autoComplete),this.isActive=!1,this.stayFocused=!1,this.dispatcher=a.dispatcher,this.preventRedirect=this.$el.data("preventRedirect"),this.listenTo(this.dispatcher,"search:getCurrentCategory",this.getCurrentCategory),this.autoComplete.on("show",this.setFormAsActive,this).on("hide",this.setFormAsInactive,this).on("request-search-type-change",this.selectCustomSearchType,this).on("request-search-param-add",this.addCustomParameter,this),this.broadcastCurrentFilter()},broadcastCurrentFilter:function(){var a={name:this.$searchType.find("strong").data("filterId"),type:"default"};return-1!==a.name.search("category")?(a.name=a.name.replace("category-",""),a.type="category",void this.dispatcher.trigger("searchFilter",a)):-1!==a.name.search("department")?(a.name=a.name.replace("department-",""),a.type="department",void this.dispatcher.trigger("searchFilter",a)):void this.dispatcher.trigger("searchFilter",a)},render:function(){this.el.setAttribute("novalidate","novalidate"),this.correctBrowserBackBehavior(),a(document).on("click",a.proxy(this.setFormAsInactive,this)),!Modernizr.input.autofocus&&this.$input.hasClass("autofocus")&&(this.$input.focus(),this.setFormAsInactive())},stopPropagation:function(a){a.stopPropagation()},validate:function(){return a.trim(this.$input.val()).length?this.preventRedirect?(b.Events.trigger("g-search-submit",{action:this.$el.attr("action"),params:{string:this.$input.val(),search_scope:this.$el.find('[name="search_scope"]').val()}}),!1):void 0:!1},toggleSearchType:function(){this.$searchType.hasClass("active")?this.searchTypeHide():this.searchTypeShow()},searchTypeShow:function(){this.isActive&&this.setFormAsInactive(),this.$searchType.addClass("active")},searchTypeHide:function(){this.$searchType.removeClass("active")},setFormAsActive:function(){this.isActive||(this.$el.addClass("active"),this.searchTypeHide(),this.isActive=!0)},setFormAsInactive:function(a){a&&"keydown"===a.type&&27!==a.which||(this.searchTypeHide(),this.$el.removeClass("active"),this.isActive=!1)},inDescriptionToggle:function(){this.stayFocused=!0},blur:function(a){this.stayFocused?this.stayFocused=!1:this.setFormAsInactive()},selectSearchType:function(b){var c=this.$el.find("select"),d=a(b.currentTarget),e=d.attr("href").split("#")[1].split("-")[0],f=this.$el.data("actions");this.currentCategory=e,this.$searchType.find("span").text(d.text()),this.$searchType.find("strong").attr("title",a.trim(d.text())),c.find("option:selected").prop("selected",!1),c.find('option[value="'+e+'"]').prop("selected",!0),e=e in f?e:"default",this.$el.attr("action",f[e].action),this.$input.attr("name",f[e].param),this.searchTypeHide(),this.$searchType.find("a.active").removeClass("active"),d.addClass("active"),a.trim(this.$input.val()).length||(this.setFormAsActive(),this.$input.focus()),b.preventDefault()},selectCustomSearchType:function(a){this.$el.find("option.custom-search-type").attr("value",a.type+"-"+a.id).prop("selected",!0)},addCustomParameter:function(a){this.$el.append('<input type="hidden" name="'+a.name+'" value="'+a.value+'">')},correctBrowserBackBehavior:function(){var a=this.$searchType.find("a.active").attr("href").split("#")[1];this.$el.find("select").find('option[value="'+a+'"]').prop("selected",!0)}});return d}),define("search/sticky-bar/views/bar",["jquery","underscore","backbone"],function(a,b,c){"use strict";var d=c.View.extend({initialize:function(){this.$wrapper=this.$el.parent(),this.wrapperTop=this.$wrapper.offset().top,this.barWrapper=this.$wrapper.parents(".main-header-wrapper"),this.barWrapperOffset=this.barWrapper.next(".sticky-header-offset"),this.treshold=this.wrapperTop+this.$wrapper.height()},render:function(){a("html").hasClass("quirks")||(a(window).bind("scroll",a.proxy(this.observePosition,this)),this.observePosition())},observePosition:function(){var b=a(window).scrollTop(),c=this.model.getStickState();this.treshold<b&&!c?this.stick():this.treshold>b&&c&&this.unStick()},stick:function(){this.model.setStickState(!0),this.barWrapper.addClass("sticky"),this.barWrapperOffset.addClass("sticky")},unStick:function(){this.model.setStickState(!1),this.barWrapper.removeClass("sticky"),this.barWrapperOffset.removeClass("sticky")}});return d}),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json",function(a){return function(){var b;return b||a.JSON}}(this)),define("search/sticky-bar/models/barStates",["jquery","backbone","json"],function(a,b,c){"use strict";var d=b.Model.extend({defaults:{isStick:!1},getStickState:function(){return this.isStick},setStickState:function(a){this.isStick=a}});return d}),define("search/sticky-bar/app",["jquery","underscore","search/sticky-bar/views/bar","search/sticky-bar/models/barStates"],function(a,b,c,d){"use strict";return function(a){a=b.defaults(a,{isHide:!1,storageName:"stickyBarHide"});var e=new d,f=new c({el:a.el,model:e});f.render()}}),define("search/app",["jquery","search/search-form","search/sticky-bar/app"],function(a,b,c){"use strict";return function(d){var e,f,g;a("#main-search").length&&(e=new b({el:"#main-search",autoComplete:{el:"#main-search",url:"/Suggest/Index.php/suggestAjax",storage:"searchAutoCompleteHistory",defaultSuggestionTplId:"#default-suggestion-tpl",inCategorySuggestionTplId:"#in-category-suggestion-tpl",inHistorySuggestionTplId:"#in-history-suggestion-tpl",historyMatchLimit:2,totalMatchLimit:10,delay:150},dispatcher:d.dispatcher}),e.render(),f=a("#maWrapper").length?{el:"#search-bar",isHide:!0,storageName:"stickyBarMaHide"}:{el:"#search-bar",storageName:"stickyBarHide"},g=new c(f))}}),define("departments/navigationBar/views/NavigationBar",["jquery","underscore","backbone","main/utils"],function(a,b,c,d){"use strict";var e=c.View.extend({events:{"manualOpen div.nav-tab":"openLayer","manualClose div.nav-tab":"closeAllLayers","mousemove div.nav-tab":"mouseOverNavElement","mouseleave div.nav-tab":"mouseOutNavElement","click a.nav-link":"clickOnNavElement","mouseover div.layer":"mouseOverLayer","mouseout div.layer":"mouseOutLayer","click .categories li.all a":"scrollToCategory"},initialize:function(){this.$navTabs=this.$("li"),this.openTimeout=0,this.closeTimeout=0,this.slideOutTimeout=0,this.openDelay=this.options.openDelay,this.resizeTimeout=0,this.$currentLayer=null,this.isTouchDevice=a("html").hasClass("touch"),this.isTouchDevice&&(this.events={})},render:function(){a("html").hasClass("quirks")&&this.flexBoxFallback(),this.options.isSideNav||(this.adjustLayerPosition(),a(window).on("resize",a.proxy(this.processResize,this)))},mouseOverNavElement:function(b){this.resetTimeouts(),this.closeTimeout=setTimeout(a.proxy(this.openLayer,this,b),this.openDelay)},mouseOutNavElement:function(){this.resetTimeouts(),this.openTimeout=setTimeout(a.proxy(this.closeAllLayers,this),this.options.closeDelay)},mouseOverLayer:function(){this.resetTimeouts()},mouseOutLayer:function(){this.closeTimeout=setTimeout(a.proxy(this.closeAllLayers,this),this.options.closeDelay)},clickOnNavElement:function(){clearTimeout(this.openTimeout)},resetTimeouts:function(){clearTimeout(this.closeTimeout),clearTimeout(this.openTimeout)},openLayer:function(a){var b=this.$(a.currentTarget).closest("li");b.hasClass("current")||(this.$currentLayer=b.find("div.nav-layer"),this.closeAllLayers(),b.addClass("current"),this.loadLayerContent(),this.openDelay/=2)},closeAllLayers:function(){this.openDelay=this.options.openDelay,this.$navTabs.removeClass("current")},loadLayerContent:function(){var b=this.$currentLayer.data("department");return this.model.isContentInCache(b)?void(this.$currentLayer.children().length<1&&this.$currentLayer.html(this.model.getCachedLayerContent(b))):(this.$currentLayer.addClass("loading"),void this.model.getLayerContent(b,{success:a.proxy(this.contentLoadSuccess,this),error:a.proxy(this.contentLoadError,this)}))},contentLoadSuccess:function(a){this.$currentLayer.removeClass("loading").html(a),this.options.isSideNav&&this.openSideNavLayer()},contentLoadError:function(a){this.$currentLayer.removeClass("loading"),this.closeAllLayers()},scrollToCategory:function(a){var b=window.location.href;b.split("#")[0]===a.currentTarget.href.split("#")[0]&&(this.closeAllLayers(),d.visual.scrollTo("#category-map"),a.preventDefault())},processResize:function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(a.proxy(this.resizeEnd,this),100)},resizeEnd:function(){this.adjustLayerPosition()},adjustLayerPosition:function(){for(var b=20,c=672,d=this.$el.outerWidth(),e=this.$el.offset().left,f=d-c,g=0,h=this.$navTabs.length;h>g;g++){var i=a(this.$navTabs[g]),j=i.find("a.nav-link").offset().left-e,k=j-f,l=0;0>k&&g>0?l=-b:k>-b&&(l=-k),i.find("div.nav-layer").css("left",l)}},flexBoxFallback:function(){var c=this.$el.outerWidth(),d=this.$navTabs.length,e=[],f=0,g=0,h=0;this.$navTabs.each(function(b,c){a(c).removeAttr("style"),e[b]=a(c).outerWidth(),f+=e[b]}),g=Math.floor((c-f)/--d/2*2),b.each(this.$navTabs,function(b,f){h=f===d?0:g,a(this.$navTabs[f]).css("width",100*(e[f]+h)/c+"%")},this)}});return e}),function(a,b){"use strict";"function"==typeof define&&define.amd?define("ajax",[],function(){return a.ajax=b()}):a.ajax=b()}(this,function(){"use strict";var a=function(){};return a.prototype.isUrlExternal=function(a){var b=new RegExp("^(?:[a-z]+:)?//","i");return b.test(a)},a.prototype.createXHRObject=function(a,b){var c=new XMLHttpRequest,d=this.isUrlExternal(a);return"withCredentials"in c||!d?c.open(b,a,!0):"undefined"!=typeof XDomainRequest?(c=new XDomainRequest,c.open(b,a)):c=null,c},a.prototype.setRequestHeaders=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b.setRequestHeader(c,a[c])},a.prototype.request=function(a){function b(){var a;4!==g.readyState||200!==g.status&&201!==g.status?"undefined"!=typeof XDomainRequest&&g instanceof XDomainRequest?d(-1!==g.contentType.indexOf("application/json")?JSON.parse(g.responseText):g.responseText):4===g.readyState&&e(g.responseText):(a=g.getResponseHeader("Content-Type"),d(a&&-1!==a.indexOf("application/json")?JSON.parse(g.responseText):g.responseText))}var c=a.url,d=a.callback,e=a.errorCallback?a.errorCallback:function(){},f=a.params?a.params:null,g=this.createXHRObject(c,a.method);void 0===g.onload?g.onreadystatechange=b:g.onload=b,g.onerror=function(){e()},this.setRequestHeaders(a.headers,g),f&&(f=this.dataSerializer(a,g)),g.send(f)},a.prototype.dataSerializer=function(a,b){return a.dataSerializer?a.dataSerializer(a.params):(b.setRequestHeader("Content-Type","application/json;charset=utf-8"),JSON.stringify(a.params))},a.prototype.get=function(a){a.method="GET",this.request(a)},a.prototype.post=function(a){a.method="POST",this.request(a)},a.prototype.put=function(a){a.method="PUT",this.request(a)},a.prototype["delete"]=function(a){a.method="DELETE",this.request(a)},a}),define("departments/navigationBar/models/NavigationBar",["jquery","backbone","ajax"],function(a,b,c){"use strict";var d=b.Model.extend({currentDepartment:null,cache:{},initialize:function(){this.ajax=new c},isContentInCache:function(a){return!!this.cache[a]},getCachedLayerContent:function(a){return this.cache[a]},getLayerContent:function(b,c){return"string"!=typeof b?c.error():(this.currentDepartment=b,void this.ajax.get({url:this.url(),callback:a.proxy(this.dataLoadSuccess,this,c.success,b),errorCallback:c.error}))},dataLoadSuccess:function(a,b,c){return this.cache[b]=c,a(c)},dataLoadError:function(a){return a()}});return d}),define("departments/navigationBar/main",["departments/navigationBar/views/NavigationBar","departments/navigationBar/models/NavigationBar","underscore"],function(a,b,c){"use strict";return function(d){var e,f;d=c.defaults(d,{openDelay:400,closeDelay:300}),e=new b,e.urlRoot=d.urlRoot,e.url=function(){return this.urlRoot+"/"+this.currentDepartment},f=new a({model:e,el:d.el,openDelay:d.openDelay,closeDelay:d.closeDelay}),f.render()}}),function(a,b){"use strict";"function"==typeof define&&define.amd?define("cookies-interface-js",[],function(){return a.cookiesInterface=b()}):a.cookiesInterface=b()}(this,function(){"use strict";var a=function(){};return a.prototype.set=function(a,b,c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="expires="+d.toUTCString();document.cookie=a+"="+b+"; "+e},a.prototype.get=function(a){var b=a+"=",c=document.cookie;c=c.split(";");for(var d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1);if(-1!==e.indexOf(b))return this.parse(e.substring(b.length,e.length))}return""},a.prototype.parse=function(a){var b=/\+/g;0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return decodeURIComponent(a.replace(b," "))}catch(c){}},a}),function(a,b){"use strict";"function"==typeof define&&define.amd?define("velalayout/GetUserLoginData",["cookies-interface-js"],function(c){return a.GetUserLoginData=b(c)}):a.GetUserLoginData=b(window.cookiesInterface)}(this,function(a){"use strict";function b(){this.userIdentityCookie=c.get("qeppo_login2"),this.userNavElements=this.getUserNavElements(),this.userIdentity=this.userIdentityCookie?JSON.parse(this.userIdentityCookie):null,this.dc2=c.get("dc2")}var c=new a;return b.prototype.getUserNavElements=function(){for(var a=document.getElementsByClassName("user-links-wrapper"),b=[],c=0;c<a.length;c++)b.push(a[c].getElementsByClassName("user-nav")[0]);return b},b.prototype.addClassForUserNavElements=function(a){for(var b=0;b<this.userNavElements.length;b++)this.userNavElements[b].className=this.userNavElements[b].className+" "+a},b.prototype.initialize=function(){return this.addClassForUserNavElements("init"),this.synchronizeRecommendationDataInLocalStorage(),this.userIdentity?void this.showLoggedUserInfo():void(this.dc2&&this.addClassForUserNavElements("session-expired"))},b.prototype.showLoggedUserInfo=function(){for(var a=this.createUserLoginLink(),b=[],c=0;c<this.userNavElements.length;c++)b.push(this.userNavElements[c].getElementsByClassName("user-login")[0]);for(var d=0;d<b.length;d++)b[d].innerHTML=a.outerHTML;this.addClassForUserNavElements("status-logged")},b.prototype.createUserLoginLink=function(){var a=this.userNavElements[0].getAttribute("data-user-card-url")+this.userIdentity.id,b=this.userIdentity.username.replace(/<|>|\"/g,""),c=document.createElement("a");return c.href=a,c.innerHTML="<span>"+b+"</span>",c},b.prototype.synchronizeRecommendationDataInLocalStorage=function(){localStorage&&localStorage.getItem("allActions")&&JSON.parse(localStorage.getItem("allActions")).ws3!==c.get("ws3")&&localStorage.removeItem("allActions")},b}),function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d=[],e={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},f=function(a,b){var c=e,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"; __p.push('"}).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"")+"');}return __p.join('');";return d};define("tpl",[],function(){var e,g,h;return"undefined"!=typeof window&&window.navigator&&window.document?g=function(a,b){var c=e.createXhr();c.open("GET",a,!0),c.onreadystatechange=function(a){4===c.readyState&&b(c.responseText)},c.send(null)}:"undefined"!=typeof process&&process.versions&&process.versions.node&&(h=require.nodeRequire("fs"),g=function(a,b){b(h.readFileSync(a,"utf8"))}),e={version:"0.24.0",strip:function(a){if(a){a=a.replace(b,"");var d=a.match(c);d&&(a=d[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"").replace(/[\t]/g,"").replace(/[\r]/g,"")},createXhr:function(){var b,c,d;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(c=0;3>c;c++){d=a[c];try{b=new ActiveXObject(d)}catch(e){}if(b){a=[d];break}}if(!b)throw new Error("require.getXhr(): XMLHttpRequest not available");return b},get:g,load:function(a,b,c,g){var h,i=!1,j=a.indexOf("."),k=a.substring(0,j),l=a.substring(j+1,a.length);j=l.indexOf("!"),-1!==j&&(i=l.substring(j+1,l.length),i="strip"===i,l=l.substring(0,j)),h="nameToUrl"in b?b.nameToUrl(k,"."+l):b.toUrl(k+"."+l),e.get(h,function(b){b=f(b),g.isBuild||(b=new Function("obj",b)),b=i?e.strip(b):b,g.isBuild&&g.inlineText&&(d[a]=b),c(b)})},write:function(a,b,c){if(b in d){var f=e.jsEscape(d[b]);c("define('"+a+"!"+b+"', function() {return function(obj) { "+f.replace(/(\\')/g,"'").replace(/(\\\\)/g,"\\")+"}});\n")}}}})}(),define("tpl!velalayout/cartStatus/templates/cartPreviewLayer.html",function(){return function(obj){var __p=[];with(obj||{})__p.push('<div class="cart-items-carousel-wrapper">    <div id="cart-items-carousel" class="cart-items-carousel">        <div class="cart-items-carousel-inner items-box">            <ul class="items-wrap">                '),_.each(items,function(a){__p.push('                    <li data-item-id="',a.id,'">                        '),a.imageUrl?__p.push('                            <a class="photo">                                <img src="',a.imageUrl,'" width="128" height="96">                            </a>                        '):__p.push('                            <a class="photo">                                <span class="no-photo"></span>                            </a>                        '),__p.push('                        <span class="price">',a.totalBuyNowPrice,'</span>                        <span class="quantity">',trans.pieces,": ",a.cartQuantity,'</span>                        <div class="additional">                            <h3><a href="',a.url,'"><span>',a.name,'</span></a></h3>                            <span class="quantity">',trans.forOnePiece," <b>",a.buyNowPrice,"</b></span>                        </div>                    </li>                ");

}),__p.push('            </ul>        </div>    </div>    <div class="cart-items-carousel-controls">        <a class="cart-items-carousel-control left" href="#prev">&lsaquo;</a>        <a class="cart-items-carousel-control right" href="#next">&rsaquo;</a>    </div></div><div class="cart-item-extra">    <p><strong>',description.cartItemsCount,"</strong> ",description.cartItemCountDesc.toLowerCase(),"</p>    <p>",trans.from," <strong>",description.sellersCount,"</strong>  ",description.sellerCountDesc.toLowerCase(),'</p>    <a href="',basketurl,'" class="primary-btn btn" title="',trans.goToCart,'">',trans.goToCart,"</a></div>");return __p.join("")}}),define("velalayout/cartStatus/views/CartPreviewView",["jquery","backbone","underscore","tpl!velalayout/cartStatus/templates/cartPreviewLayer.html"],function(a,b,c,d){"use strict";var e=4,f=b.View.extend({events:{"slid #cart-items-carousel":"checkBoundaryConditions","click a.left":"switchToPrevSlide","click a.right":"switchToNextSlide"},initialize:function(){this.$itemsWrap=null,this.$controls=null,this.itemsCount=null,this.itemWidth=null,this.slidesCount=null,this.currentSlide=null},render:function(){var a=this.model.toJSON();return a.items?(this.itemsCount=a.items.length,this.$el.html(d(a)),this.$el.removeClass("spinner"),this.initializeCarousel(),this):this},initializeCarousel:function(){return this.slidesCount=Math.ceil(this.itemsCount/e),this.currentSlide=1,this.$itemsWrap=this.$("ul.items-wrap"),this.itemWidth=this.$("ul.items-wrap li").outerWidth(),this.adjustLayerSizeToExposedItems(),this.itemsCount>1&&this.adjustCarouselToExposedItems(),this.slidesCount>1?(this.$el.addClass("show-controls"),this.$controls=this.$("a.cart-items-carousel-control"),this.checkBoundaryConditions()):this.$el.removeClass("show-controls"),this},adjustLayerSizeToExposedItems:function(){this.$itemsWrap.css("width",this.itemsCount*this.itemWidth)},adjustCarouselToExposedItems:function(){var a=this.itemsCount>e?e:this.itemsCount;this.$("div.cart-items-carousel").css("width",a*this.itemWidth)},switchToNextSlide:function(a){this.currentSlide<this.slidesCount&&this.slideTo(this.currentSlide+1),a.preventDefault()},switchToPrevSlide:function(a){this.currentSlide>1&&this.slideTo(this.currentSlide-1),a.preventDefault()},slideTo:function(a){var b=a*e*this.itemWidth,c=this.itemsCount*this.itemWidth,d=-(Math.min(b,c)-e*this.itemWidth);this.$itemsWrap.css("left",d),this.currentSlide=a,this.checkBoundaryConditions()},checkBoundaryConditions:function(){var b=a(this.$controls[0]),c=a(this.$controls[1]);this.$controls.removeClass("unactive"),1===this.currentSlide?b.addClass("unactive"):this.currentSlide===this.slidesCount&&c.addClass("unactive")},clear:function(){this.$el.html(""),this.$el.addClass("spinner")}});return f}),function(a){"function"==typeof define&&define.amd?define("jquery.cookie",["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(b){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setTime(+k+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0===a.cookie(b)?!1:(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}}),define("velalayout/cartStatus/views/CartStatusView",["velalayout/cartStatus/views/CartPreviewView","backbone","jquery","jquery.cookie"],function(a,b,c){"use strict";var d=b.View.extend({events:{mouseenter:"mouseEnterCartStatus",mouseleave:"mouseLeaveCartStatus"},initialize:function(b){this.openDelay=this.options.openDelay||500,this.closeDelay=this.options.closeDelay||400,this.addedItemOpenDelay=this.options.addedItemOpenDelay||2e3,this.openTimeout=null,this.closeTimeout=null,this.closeNewItemTimeout=null,this.addedItem=null,c("html").hasClass("touch")&&(this.events={}),this.cartPreviewView=new a({el:this.$("div.cart-preview"),model:this.model})},updateCartStatus:function(){var a=c.cookie("cartCount"),b=this.getCartTotalPrice();parseInt(a,10)?(this.$el.removeClass("empty"),this.$("span.count i").text(a),this.$("span.price").text(b)):(this.$("span.count i").text("0"),this.$("span.price").text(this.model.get("trans").cartIsEmpty),this.$el.addClass("empty")),this.$el.addClass("init")},getCartTotalPrice:function(){var a=(c.cookie("cartTotalPrice")||"").replace(/\+/g," ");return a.indexOf(" <")>0&&(a=a.slice(0,a.indexOf(" <"))),a},mouseEnterCartStatus:function(){clearTimeout(this.closeTimeout),clearTimeout(this.closeNewItemTimeout),this.$el.hasClass("active")||(this.openTimeout=setTimeout(c.proxy(this.openCartPreviewLayer,this),this.openDelay))},mouseLeaveCartStatus:function(){clearTimeout(this.openTimeout),this.closeTimeout=setTimeout(c.proxy(this.hideCartPreviewLayer,this),this.closeDelay)},openCartPreviewLayer:function(){this.updateCartStatus(),this.$el.hasClass("empty")||(this.$el.addClass("active"),this.model.fetch({cache:!1,success:c.proxy(this.showLayerContent,this),error:c.proxy(this.hideCartPreviewLayer,this)}))},hideCartPreviewLayer:function(){this.$el.removeClass("active"),this.$el.find("li").removeClass("blink"),this.cartPreviewView.clear(),clearTimeout(this.closeNewItemTimeout)},showLayerContent:function(){this.cartPreviewView.render(),this.addedItem&&(this.blinkNewItem(this.addedItem.get("id")),this.closeNewItemTimeout=setTimeout(c.proxy(this.hideCartPreviewLayer,this),this.addedItemOpenDelay),this.addedItem=null)},blinkNewItem:function(a){this.$el.find('[data-item-id="'+a+'"]').addClass("blink")},refreshBasket:function(a){this.addedItem=a,this.hideCartPreviewLayer(),this.mouseEnterCartStatus()}});return d}),define("velalayout/cartStatus/views/AddToCartView",["jquery","backbone"],function(a,b){"use strict";var c=b.View.extend({events:{"click .new-basket-flow":"clickHandler"},initialize:function(a){this.cartStatusView=this.options.cartStatusView||null,this.cartStatusView&&this.cartStatusView.listenTo(this,"refreshBasket",this.cartStatusView.refreshBasket)},clickHandler:function(b){b.preventDefault(),this.saveData(a(b.currentTarget))},saveData:function(a){var b=this.$el.find("#item-quantity-input"),c=1;this.isValid(a)&&(this.disableBtn(a),b.length&&(c=b.val()),this.model.set({id:a.data("id"),cartid:a.data("cartid"),quantity:c,quantityAdd:1,sesstoken:a.data("sesstoken")}),this.fetchIt(a))},isValid:function(a){var b=a.data("id")||"",c=a.data("sesstoken")||"";return""!==b&&""!==c},fetchIt:function(b){this.model.fetch({data:a.param(this.model.toJSON()),success:a.proxy(this.refreshBasket,this,b),error:a.proxy(this.enableBtn,this,b)})},refreshBasket:function(a){this.enableBtn(a),this.trigger("refreshBasket",this.model)},disableBtn:function(a){a.attr("disabled","disabled")},enableBtn:function(a){a.removeAttr("disabled")}});return c}),define("velalayout/cartStatus/main",["velalayout/cartStatus/views/CartStatusView","velalayout/cartStatus/views/AddToCartView","jquery","backbone","jquery.cookie"],function(a,b,c,d){"use strict";return{initialize:function(e){if("1"===c.cookie("cartVersion"))return c(e.el).hide(),void c("#cart-status-header").show().removeClass("hidden");var f=new d.Model;f.url=e.previewUrl,f.set("trans",c(e.el).data("trans")),f.set("basketurl",c(e.el).data("basket-url"));var g=new a({model:f,el:e.el});g.updateCartStatus();var h="#siBidForm2",i=c("#listing").length;if(c("#add-to-cart-btn").length||i){i&&(h="body");var j=new d.Model;j.url=e.addUrl;{new b({model:j,el:h,cartStatusView:g})}}}}}),define("velalayout/login-tip",["jquery","jquery.cookie"],function(a){"use strict";var b,c="authenticationHint",d=location.host.split(".");return function(){a.cookie(c)&&"function"==typeof a.fn.popover&&(a("#user-login a").popover("show"),a("a.popover-close").on("click",function(e){for(e.preventDefault(),b=0;b<d.length-1;b++){var f="."+d.slice(b,d.length).join(".");a.cookie(c,{path:"/",domain:f,expires:-1})}a("#user-login a").popover("destroy")}))}}),define("cookiepolicy/views/banner",["jquery","underscore","backbone"],function(a,b,c){"use strict";var d=c.View.extend({events:{"click a.close":"hideBanner"},anchorTemplate:b.template('<a target="_blank" href="<%= url %>"><span><%= anchor %></span></a>'),initialize:function(){this.template=this.options.template},render:function(){this.model.getStorage(this.options.storageName)||a("body > .main-wrapper").prepend(a(this.renderBanner()))},renderBanner:function(){return this.setElement(this.template({message:this.prepareMessage()})),this.$el},prepareMessage:function(){var a=this.options.langs,b=this.anchorTemplate({url:this.options.policyPageUrl,anchor:a.anchor});return a.message.replace("%link%",b)},hideBanner:function(b){b.preventDefault(),a(this.$el.children("div")[0]).addClass("slide-out"),this.model.setStorage(this.options.storageName,!0)}});return d}),define("cookiepolicy/models/storage",[],function(){"use strict";var a=function(){};return a.prototype={getStorage:function(a){if("string"!=typeof a&&a.length)throw new TypeError("Param name must be a string");return localStorage.getItem(a)},setStorage:function(a,b){if("undefined"==typeof a||"undefined"==typeof b)throw new TypeError("Params name and value required");localStorage.setItem(a,b)}},a}),define("tpl!cookiepolicy/templates/banner.html",function(){return function(obj){var __p=[];with(obj||{})__p.push('<div class="vela">    <div class="cookie-policy-banner vela" id="cookie-policy-banner">        <div class="inner">            <p>',message,'</p>            <a class="close" href="#close">&times;</a>        </div>    </div></div>');return __p.join("")}}),define("cookiepolicy/main",["underscore","cookiepolicy/views/banner","cookiepolicy/models/storage","tpl!cookiepolicy/templates/banner.html"],function(a,b,c,d){"use strict";return function(e){var f;e=a.defaults(e,{storageName:"policyBannerHide"}),f=new b({model:new c,template:d,storageName:e.storageName,langs:e.langs,policyPageUrl:e.policyPageUrl}),f.render()}}),function(a,b){"use strict";function c(){d.READY||(d.event.determineEventTypes(),d.utils.each(d.gestures,function(a){d.detection.register(a)}),d.event.onTouch(d.DOCUMENT,d.EVENT_MOVE,d.detection.detect),d.event.onTouch(d.DOCUMENT,d.EVENT_END,d.detection.detect),d.READY=!0)}var d=function(a,b){return new d.Instance(a,b||{})};d.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},d.HAS_POINTEREVENTS=a.navigator.pointerEnabled||a.navigator.msPointerEnabled,d.HAS_TOUCHEVENTS="ontouchstart"in a,d.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,d.NO_MOUSEEVENTS=d.HAS_TOUCHEVENTS&&a.navigator.userAgent.match(d.MOBILE_REGEX),d.EVENT_TYPES={},d.DIRECTION_DOWN="down",d.DIRECTION_LEFT="left",d.DIRECTION_UP="up",d.DIRECTION_RIGHT="right",d.POINTER_MOUSE="mouse",d.POINTER_TOUCH="touch",d.POINTER_PEN="pen",d.EVENT_START="start",d.EVENT_MOVE="move",d.EVENT_END="end",d.DOCUMENT=a.document,d.plugins=d.plugins||{},d.gestures=d.gestures||{},d.READY=!1,d.utils={extend:function(a,c,d){for(var e in c)a[e]!==b&&d||(a[e]=c[e]);return a},each:function(a,c,d){var e,f;if("forEach"in a)a.forEach(c,d);else if(a.length!==b){for(e=0,f=a.length;f>e;e++)if(c.call(d,a[e],e,a)===!1)return}else for(e in a)if(a.hasOwnProperty(e)&&c.call(d,a[e],e,a)===!1)return},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){var b=[],c=[];return d.utils.each(a,function(a){b.push("undefined"!=typeof a.clientX?a.clientX:a.pageX),c.push("undefined"!=typeof a.clientY?a.clientY:a.pageY)}),{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2}},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.pageY-a.pageY,d=b.pageX-a.pageX;return 180*Math.atan2(c,d)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.pageX-b.pageX),e=Math.abs(a.pageY-b.pageY);return c>=e?a.pageX-b.pageX>0?d.DIRECTION_LEFT:d.DIRECTION_RIGHT:a.pageY-b.pageY>0?d.DIRECTION_UP:d.DIRECTION_DOWN},getDistance:function(a,b){var c=b.pageX-a.pageX,d=b.pageY-a.pageY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==d.DIRECTION_UP||a==d.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,b){b&&a&&a.style&&(d.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(c){d.utils.each(b,function(b){c&&(b=c+b.substring(0,1).toUpperCase()+b.substring(1)),b in a.style&&(a.style[b]=b)})}),"none"==b.userSelect&&(a.onselectstart=function(){return!1}),"none"==b.userDrag&&(a.ondragstart=function(){return!1}))}},d.Instance=function(a,b){var e=this;return c(),this.element=a,this.enabled=!0,this.options=d.utils.extend(d.utils.extend({},d.defaults),b||{}),this.options.stop_browser_behavior&&d.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),d.event.onTouch(a,d.EVENT_START,function(a){e.enabled&&d.detection.startDetect(e,a)}),this},d.Instance.prototype={on:function(a,b){var c=a.split(" ");return d.utils.each(c,function(a){this.element.addEventListener(a,b,!1)},this),this},off:function(a,b){var c=a.split(" ");return d.utils.each(c,function(a){this.element.removeEventListener(a,b,!1)},this),this},trigger:function(a,b){b||(b={});var c=d.DOCUMENT.createEvent("Event");c.initEvent(a,!0,!0),c.gesture=b;var e=this.element;return d.utils.hasParent(b.target,e)&&(e=b.target),e.dispatchEvent(c),this},enable:function(a){return this.enabled=a,this}};var e=null,f=!1,g=!1;d.event={bindDom:function(a,b,c){var e=b.split(" ");d.utils.each(e,function(b){a.addEventListener(b,c,!1)})},onTouch:function(a,b,c){var h=this;this.bindDom(a,d.EVENT_TYPES[b],function(i){var j=i.type.toLowerCase();if(!j.match(/mouse/)||!g){j.match(/touch/)||j.match(/pointerdown/)||j.match(/mouse/)&&1===i.which?f=!0:j.match(/mouse/)&&!i.which&&(f=!1),j.match(/touch|pointer/)&&(g=!0);var k=0;f&&(d.HAS_POINTEREVENTS&&b!=d.EVENT_END?k=d.PointerEvent.updatePointer(b,i):j.match(/touch/)?k=i.touches.length:g||(k=j.match(/up/)?0:1),k>0&&b==d.EVENT_END?b=d.EVENT_MOVE:k||(b=d.EVENT_END),(k||null===e)&&(e=i),c.call(d.detection,h.collectEventData(a,b,h.getTouchList(e,b),i)),d.HAS_POINTEREVENTS&&b==d.EVENT_END&&(k=d.PointerEvent.updatePointer(b,i))),k||(e=null,f=!1,g=!1,d.PointerEvent.reset())}})},determineEventTypes:function(){var a;a=d.HAS_POINTEREVENTS?d.PointerEvent.getEvents():d.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],d.EVENT_TYPES[d.EVENT_START]=a[0],d.EVENT_TYPES[d.EVENT_MOVE]=a[1],d.EVENT_TYPES[d.EVENT_END]=a[2]},getTouchList:function(a){return d.HAS_POINTEREVENTS?d.PointerEvent.getTouchList():a.touches?a.touches:(a.identifier=1,[a])},collectEventData:function(a,b,c,e){var f=d.POINTER_TOUCH;return(e.type.match(/mouse/)||d.PointerEvent.matchType(d.POINTER_MOUSE,e))&&(f=d.POINTER_MOUSE),{center:d.utils.getCenter(c),timeStamp:(new Date).getTime(),target:e.target,touches:c,eventType:b,pointerType:f,srcEvent:e,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return d.detection.stopDetect()}}}},d.PointerEvent={pointers:{},getTouchList:function(){var a=this,b=[];return d.utils.each(a.pointers,function(a){b.push(a)}),b},updatePointer:function(a,b){return a==d.EVENT_END?this.pointers={}:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b),Object.keys(this.pointers).length},matchType:function(a,b){if(!b.pointerType)return!1;var c=b.pointerType,e={};return e[d.POINTER_MOUSE]=c===b.MSPOINTER_TYPE_MOUSE||c===d.POINTER_MOUSE,e[d.POINTER_TOUCH]=c===b.MSPOINTER_TYPE_TOUCH||c===d.POINTER_TOUCH,e[d.POINTER_PEN]=c===b.MSPOINTER_TYPE_PEN||c===d.POINTER_PEN,e[a]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},d.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:d.utils.extend({},b),lastEvent:!1,name:""},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);var b=this.current.inst.options;return d.utils.each(this.gestures,function(c){return this.stopped||b[c.name]===!1||c.handler.call(c,a,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=a),a.eventType==d.EVENT_END&&!a.touches.length-1&&this.stopDetect(),a}},stopDetect:function(){this.previous=d.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(a){var b=this.current.startEvent;!b||a.touches.length==b.touches.length&&a.touches!==b.touches||(b.touches=[],d.utils.each(a.touches,function(a){b.touches.push(d.utils.extend({},a))}));var c,e,f=a.timeStamp-b.timeStamp,g=a.center.pageX-b.center.pageX,h=a.center.pageY-b.center.pageY,i=d.utils.getVelocity(f,g,h);return"end"===a.eventType?(c=this.current.lastEvent&&this.current.lastEvent.interimAngle,e=this.current.lastEvent&&this.current.lastEvent.interimDirection):(c=this.current.lastEvent&&d.utils.getAngle(this.current.lastEvent.center,a.center),e=this.current.lastEvent&&d.utils.getDirection(this.current.lastEvent.center,a.center)),d.utils.extend(a,{deltaTime:f,deltaX:g,deltaY:h,velocityX:i.x,velocityY:i.y,distance:d.utils.getDistance(b.center,a.center),angle:d.utils.getAngle(b.center,a.center),interimAngle:c,direction:d.utils.getDirection(b.center,a.center),interimDirection:e,scale:d.utils.getScale(b.touches,a.touches),rotation:d.utils.getRotation(b.touches,a.touches),startEvent:b}),a},register:function(a){var c=a.defaults||{};return c[a.name]===b&&(c[a.name]=!0),d.utils.extend(d.defaults,c,!0),a.index=a.index||1e3,this.gestures.push(a),this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),this.gestures}},d.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(a,b){if(d.detection.current.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(b.options.drag_max_touches>0&&a.touches.length>b.options.drag_max_touches))switch(a.eventType){case d.EVENT_START:this.triggered=!1;break;case d.EVENT_MOVE:if(a.distance<b.options.drag_min_distance&&d.detection.current.name!=this.name)return;if(d.detection.current.name!=this.name&&(d.detection.current.name=this.name,b.options.correct_for_drag_min_distance&&a.distance>0)){var c=Math.abs(b.options.drag_min_distance/a.distance);d.detection.current.startEvent.center.pageX+=a.deltaX*c,d.detection.current.startEvent.center.pageY+=a.deltaY*c,a=d.detection.extendEventData(a)}(d.detection.current.lastEvent.drag_locked_to_axis||b.options.drag_lock_to_axis&&b.options.drag_lock_min_distance<=a.distance)&&(a.drag_locked_to_axis=!0);var e=d.detection.current.lastEvent.direction;a.drag_locked_to_axis&&e!==a.direction&&(a.direction=d.utils.isVertical(e)?a.deltaY<0?d.DIRECTION_UP:d.DIRECTION_DOWN:a.deltaX<0?d.DIRECTION_LEFT:d.DIRECTION_RIGHT),this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.trigger(this.name,a),b.trigger(this.name+a.direction,a),(b.options.drag_block_vertical&&d.utils.isVertical(a.direction)||b.options.drag_block_horizontal&&!d.utils.isVertical(a.direction))&&a.preventDefault();break;case d.EVENT_END:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}},d.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(a,b){switch(a.eventType){case d.EVENT_START:clearTimeout(this.timer),d.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==d.detection.current.name&&b.trigger("hold",a)},b.options.hold_timeout);break;case d.EVENT_MOVE:a.distance>b.options.hold_threshold&&clearTimeout(this.timer);break;case d.EVENT_END:clearTimeout(this.timer)}}},d.gestures.Release={name:"release",index:1/0,handler:function(a,b){a.eventType==d.EVENT_END&&b.trigger(this.name,a)}},d.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(a,b){if(a.eventType==d.EVENT_END){if(b.options.swipe_max_touches>0&&a.touches.length<b.options.swipe_min_touches&&a.touches.length>b.options.swipe_max_touches)return;(a.velocityX>b.options.swipe_velocity||a.velocityY>b.options.swipe_velocity)&&(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}}},d.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(a,b){if(a.eventType==d.EVENT_END&&"touchcancel"!=a.srcEvent.type){var c=d.detection.previous,e=!1;if(a.deltaTime>b.options.tap_max_touchtime||a.distance>b.options.tap_max_distance)return;c&&"tap"==c.name&&a.timeStamp-c.lastEvent.timeStamp<b.options.doubletap_interval&&a.distance<b.options.doubletap_distance&&(b.trigger("doubletap",a),e=!0),(!e||b.options.tap_always)&&(d.detection.current.name="tap",b.trigger(d.detection.current.name,a))}}},d.gestures.Touch={name:"touch",index:-(1/0),defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(a,b){return b.options.prevent_mouseevents&&a.pointerType==d.POINTER_MOUSE?void a.stopDetect():(b.options.prevent_default&&a.preventDefault(),void(a.eventType==d.EVENT_START&&b.trigger(this.name,a)))}},d.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(a,b){if(d.detection.current.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(a.touches.length<2))switch(b.options.transform_always_block&&a.preventDefault(),a.eventType){case d.EVENT_START:this.triggered=!1;break;case d.EVENT_MOVE:var c=Math.abs(1-a.scale),e=Math.abs(a.rotation);if(c<b.options.transform_min_scale&&e<b.options.transform_min_rotation)return;d.detection.current.name=this.name,this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.trigger(this.name,a),e>b.options.transform_min_rotation&&b.trigger("rotate",a),c>b.options.transform_min_scale&&(b.trigger("pinch",a),b.trigger("pinch"+(a.scale<1?"in":"out"),a));break;case d.EVENT_END:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("hammer",[],function(){return d}):"object"==typeof module&&"object"==typeof module.exports?module.exports=d:a.Hammer=d}(this),define("navigation/views/NavigationAbstractView",["backbone"],function(a){"use strict";return a.View.extend({cmEventsQueue:[],close:function(){this.remove(),this.unbind(),this.onClose&&this.onClose()},getReferer:function(){return"?ref=side-navigation"},sendQueuedEvents:function(){var a,b=0;for(b;b<this.cmEventsQueue.length;b++){a=this.cmEventsQueue[b];try{window.cm.event(a)}catch(c){window.console.info("Fail to log cookie monster "+a.cat+" event.")}}this.cmEventsQueue.length=0},sendEventForCookieMonster:function(a,b,c,d){var e={cat:b,a:c,lab:a};void 0!==d&&(e.v=d),this.cmEventsQueue.push(e),"undefined"!=typeof window.cm&&this.sendQueuedEvents()}})}),define("tpl!navigation/templates/department-template.html",function(){return function(obj){var __p=[];with(obj||{})__p.push('<span class="department-name">',label,'</span><i class="sprite arrow-right icon-arrow"></i>');return __p.join("")}}),define("navigation/views/departments-list/DepartmentView",["backbone","underscore","navigation/views/NavigationAbstractView","tpl!navigation/templates/department-template.html"],function(a,b,c,d){"use strict";var e=c.extend({tagName:"li",className:"department",isClicked:!1,events:{click:"changeDepartment"},changeDepartment:function(){this.isClicked||(this.isClicked=!0,this.$el.trigger("animateForward"),this.$el.trigger("changeDepartment",this.model.get("name")))},redirectToDepartment:function(){window.location.pathname=this.model.get("url")},render:function(){return this.$el.html(d(this.model.toJSON())),this}});return e}),define("navigation/views/departments-list/DepartmentsListView",["underscore","backbone","navigation/views/NavigationAbstractView","navigation/views/departments-list/DepartmentView"],function(a,b,c,d){"use strict";var e=c.extend({tagName:"ul",className:function(){return"navigation-tab departments-list "+this.options.animationDirection},initialize:function(a){this._views=[],this.departmentsCollection=a.departmentsCollection,this.animationDirection=a.animationDirection},createSubViews:function(){var a=this;this.departmentsCollection.each(function(b){a._views.push(new d({model:b}))})},render:function(){this.createSubViews();var b=document.createDocumentFragment();return a.each(this._views,function(a){b.appendChild(a.render().el)}),this.$el.append(b),this},onClose:function(){a.each(this._views,function(a){a.close()})}});return e}),define("tpl!navigation/templates/current-category-template.html",function(){return function(obj){var __p=[];with(obj||{})__p.push('<i class="sprite arrow-left icon-arrow"></i><span class="current-category-name separator-right">',name,'</span><a href="/',alias,'" class="sprite th-list-icon go-to-current-category"></a>');return __p.join("")}}),define("navigation/views/navigation-tab/CurrentCategoryView",["backbone","underscore","navigation/views/NavigationAbstractView","tpl!navigation/templates/current-category-template.html"],function(a,b,c,d){"use strict";var e=c.extend({tagName:"header",className:"current-category",template:null,isClicked:!1,events:{"click .current-category-name":"goBack"},initialize:function(a){a=b.defaults(a,{template:d}),this.template=a.template},goBack:function(){return this.isClicked?void 0:(this.isClicked=!0,this.$el.trigger("animateBack"),void 0===this.model.get("parentId")?void this.$el.trigger("showDepartmentsList"):0!==this.model.get("parentId")?void this.$el.trigger("changeCategory",this.model.get("parentId")):void this.$el.trigger("showCurrentCategoryDepartment",this.model.get("categoryId")))},addReferer:function(){var a=this.model.get("alias");a||(a=this.model.get("url")),a+=this.getReferer(),this.model.set("alias",a)},render:function(){return this.addReferer(),this.$el.html(this.template(this.model.toJSON())),this}});return e}),define("tpl!navigation/templates/sub-category-template.html",function(){return function(obj){var __p=[];with(obj||{})__p.push(""),1==leaf?__p.push('    <a href="/',alias,'" class="category-name category-leaf">',name,"</a>"):__p.push('    <span class="category-name">',name,'</span>    <i class="sprite arrow-right icon-arrow"></i>'),__p.push("");return __p.join("")}}),define("navigation/views/navigation-tab/SubCategoryView",["backbone","navigation/views/NavigationAbstractView","tpl!navigation/templates/sub-category-template.html"],function(a,b,c){"use strict";var d=b.extend({tagName:"li",isDepartmentSubView:!1,isClicked:!1,baseClass:"sub-category",categoryEvents:{click:"selectCategory"},activeLeafEvents:{click:"preventRedirect"},preventRedirect:function(a){a.preventDefault()},getClass:function(){return this.model.get("active")?this.baseClass+" active":this.baseClass},setClass:function(){this.$el.addClass(this.getClass())},setEvents:function(){return this.model.get("leaf")?void(this.model.get("active")&&(this.events=this.activeLeafEvents)):void(this.events=this.categoryEvents)},initialize:function(a){this.isDepartmentSubView=a.isDepartmentSubView,this.isDepartmentSubView&&this.parseDepartmentSubViewModel(),this.setClass(),this.setEvents()},selectCategory:function(){this.isClicked||(this.isClicked=!0,this.$el.trigger("animateForward"),this.$el.trigger("changeCategory",this.model.get("categoryId")))},parseDepartmentSubViewModel:function(){var b,c=new a.Model;for(b in this.model)this.model.hasOwnProperty(b)&&c.set(b,this.model[b]);this.model=c},addReferer:function(){var a=this.model.get("alias");a+=this.getReferer(),this.model.set("alias",a)},render:function(){return this.addReferer(),this.$el.html(c(this.model.toJSON())),this}});return d}),define("navigation/views/navigation-tab/SubCategoriesListView",["underscore","backbone","navigation/views/NavigationAbstractView","navigation/views/navigation-tab/SubCategoryView"],function(a,b,c,d){"use strict";var e=c.extend({tagName:"ul",className:"sub-categories-list",initialize:function(a){this._views=[],this.categoriesList=a.categoriesList,this.isDepartmentSubView=a.isDepartmentSubView,this.sortCategoriesList=a.sortCategoriesList,this.sortCategoriesList&&this.sortCategoriesByPosition(),this.createCategoriesSubViews()},createCategoriesSubViews:function(){var a=0;for(a;a<this.categoriesList.length;a++)this._views.push(new d({isDepartmentSubView:this.isDepartmentSubView,model:this.categoriesList[a]}))},sortCategoriesByPosition:function(){this.categoriesList.sort(function(a,b){return a.get("position")-b.get("position")})},render:function(){var b=document.createDocumentFragment();return a.each(this._views,function(a){b.appendChild(a.render().el)}),this.$el.html(b),this},onClose:function(){a.each(this._views,function(a){a.remove()})}});return e}),define("navigation/views/navigation-tab/CategoryTabView",["underscore","backbone","navigation/views/NavigationAbstractView","navigation/views/navigation-tab/CurrentCategoryView","navigation/views/navigation-tab/SubCategoriesListView"],function(a,b,c,d,e){"use strict";var f=c.extend({tagName:"article",currentCategory:null,className:function(){return"navigation-tab category-tab "+this.options.animationDirection},initialize:function(a){this.currentCategory=a.currentCategory,this.categoriesList=a.categoriesList,this.animationDirection=a.animationDirection},render:function(){var a=document.createDocumentFragment();return this.currentCategoryView=new d({model:this.currentCategory}),a.appendChild(this.currentCategoryView.render().el),this.categoriesList.length>0&&(this.subCategoriesListView=new e({categoriesList:this.categoriesList,sortCategoriesList:!0}),a.appendChild(this.subCategoriesListView.render().el)),this.$el.append(a),this},onClose:function(){this.currentCategoryView.close(),this.categoriesList.length>0&&this.subCategoriesListView.close()}});return f}),define("tpl!navigation/templates/current-department-template.html",function(){return function(obj){var __p=[];with(obj||{})__p.push('<i class="sprite arrow-left icon-arrow"></i><span class="current-category-name separator-right">',label,'</span><a href="',alias,'" class="sprite th-list-icon go-to-current-category"></a>');return __p.join("")}}),define("navigation/views/navigation-tab/DepartmentTabView",["underscore","backbone","navigation/views/NavigationAbstractView","navigation/views/navigation-tab/CurrentCategoryView","navigation/views/navigation-tab/SubCategoriesListView","tpl!navigation/templates/current-department-template.html"],function(a,b,c,d,e,f){
"use strict";var g=c.extend({tagName:"article",currentDepartment:null,className:function(){return"navigation-tab departments-tab "+this.options.animationDirection},initialize:function(a){this.currentDepartment=a.currentDepartment,this.animationDirection=a.animationDirection},render:function(){var a=document.createDocumentFragment();return this.currentDepartmentView=new d({template:f,model:this.currentDepartment}),this.subCategoriesListView=new e({isDepartmentSubView:!0,categoriesList:this.currentDepartment.get("categories"),sortCategoriesList:!1}),a.appendChild(this.currentDepartmentView.render().el),a.appendChild(this.subCategoriesListView.render().el),this.$el.html(a),this},onClose:function(){this.currentDepartmentView.close(),this.subCategoriesListView.close()}});return g}),define("tpl!navigation/templates/sidenavigation-default-template.html",function(){return function(obj){var __p=[];with(obj||{})__p.push('<section class="navigation-tabs"></section><section class="user-nav-container"></section>');return __p.join("")}}),function(a,b){var c=a.document,d=c.documentElement,e="overthrow-enabled",f="ontouchmove"in c,g="WebkitOverflowScrolling"in d.style||"msOverflowStyle"in d.style||!f&&a.screen.width>800||function(){var b=a.navigator.userAgent,c=b.match(/AppleWebKit\/([0-9]+)/),d=c&&c[1],e=c&&d>=534;return b.match(/Android ([0-9]+)/)&&RegExp.$1>=3&&e||b.match(/ Version\/([0-9]+)/)&&RegExp.$1>=0&&a.blackberry&&e||b.indexOf("PlayBook")>-1&&e&&-1===!b.indexOf("Android 2")||b.match(/Firefox\/([0-9]+)/)&&RegExp.$1>=4||b.match(/wOSBrowser\/([0-9]+)/)&&RegExp.$1>=233&&e||b.match(/NokiaBrowser\/([0-9\.]+)/)&&7.3===parseFloat(RegExp.$1)&&c&&d>=533}();a.overthrow={},a.overthrow.enabledClassName=e,a.overthrow.addClass=function(){-1===d.className.indexOf(a.overthrow.enabledClassName)&&(d.className+=" "+a.overthrow.enabledClassName)},a.overthrow.removeClass=function(){d.className=d.className.replace(a.overthrow.enabledClassName,"")},a.overthrow.set=function(){g&&a.overthrow.addClass()},a.overthrow.canBeFilledWithPoly=f,a.overthrow.forget=function(){a.overthrow.removeClass()},a.overthrow.support=g?"native":"none"}(this),function(a,b,c){if(b!==c){b.easing=function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},b.tossing=!1;var d;b.toss=function(a,e){b.intercept();var f,g,h=0,i=a.scrollLeft,j=a.scrollTop,k={top:"+0",left:"+0",duration:50,easing:b.easing,finished:function(){}},l=!1;if(e)for(var m in k)e[m]!==c&&(k[m]=e[m]);return"string"==typeof k.left?(k.left=parseFloat(k.left),f=k.left+i):(f=k.left,k.left=k.left-i),"string"==typeof k.top?(k.top=parseFloat(k.top),g=k.top+j):(g=k.top,k.top=k.top-j),b.tossing=!0,d=setInterval(function(){h++<k.duration?(a.scrollLeft=k.easing(h,i,k.left,k.duration),a.scrollTop=k.easing(h,j,k.top,k.duration)):(f!==a.scrollLeft?a.scrollLeft=f:(l&&k.finished(),l=!0),g!==a.scrollTop?a.scrollTop=g:(l&&k.finished(),l=!0),b.intercept())},1),{top:g,left:f,duration:b.duration,easing:b.easing}},b.intercept=function(){clearInterval(d),b.tossing=!1}}}(this,this.overthrow),function(a,b,c){if(b!==c){b.scrollIndicatorClassName="overthrow";var d=a.document,e=d.documentElement,f="native"===b.support,g=b.canBeFilledWithPoly,h=(b.configure,b.set),i=b.forget,j=b.scrollIndicatorClassName;b.closest=function(a,c){return!c&&a.className&&a.className.indexOf(j)>-1&&a||b.closest(a.parentNode)};var k=!1;b.set=function(){if(h(),!k&&!f&&g){a.overthrow.addClass(),k=!0,b.support="polyfilled",b.forget=function(){i(),k=!1,d.removeEventListener&&d.removeEventListener("touchstart",u,!1)};var j,l,m,n,o=[],p=[],q=function(){o=[],l=null},r=function(){p=[],m=null},s=function(a){n=j.querySelectorAll("textarea, input");for(var b=0,c=n.length;c>b;b++)n[b].style.pointerEvents=a},t=function(a,b){if(d.createEvent){var e,f=(!b||b===c)&&j.parentNode||j.touchchild||j;f!==j&&(e=d.createEvent("HTMLEvents"),e.initEvent("touchend",!0,!0),j.dispatchEvent(e),f.touchchild=j,j=f,f.dispatchEvent(a))}},u=function(a){if(b.intercept&&b.intercept(),q(),r(),j=b.closest(a.target),j&&j!==e&&!(a.touches.length>1)){s("none");var c=a,d=j.scrollTop,f=j.scrollLeft,g=j.offsetHeight,h=j.offsetWidth,i=a.touches[0].pageY,k=a.touches[0].pageX,n=j.scrollHeight,u=j.scrollWidth,v=function(a){var b=d+i-a.touches[0].pageY,e=f+k-a.touches[0].pageX,s=b>=(o.length?o[0]:0),v=e>=(p.length?p[0]:0);b>0&&n-g>b||e>0&&u-h>e?a.preventDefault():t(c),l&&s!==l&&q(),m&&v!==m&&r(),l=s,m=v,j.scrollTop=b,j.scrollLeft=e,o.unshift(b),p.unshift(e),o.length>3&&o.pop(),p.length>3&&p.pop()},w=function(a){s("auto"),setTimeout(function(){s("none")},450),j.removeEventListener("touchmove",v,!1),j.removeEventListener("touchend",w,!1)};j.addEventListener("touchmove",v,!1),j.addEventListener("touchend",w,!1)}};d.addEventListener("touchstart",u,!1)}}}}(this,this.overthrow),function(a,b){a.overthrow.set()}(this),define("overthrow",function(){}),define("navigation/views/SideNavigationView",["jquery","underscore","backbone","hammer","navigation/views/NavigationAbstractView","navigation/views/departments-list/DepartmentsListView","navigation/views/navigation-tab/CategoryTabView","navigation/views/navigation-tab/DepartmentTabView","tpl!navigation/templates/sidenavigation-default-template.html","overthrow"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=e.extend({userNavigationContainer:null,navigationTabsContainer:null,html:null,contentContainer:null,animationDuration:300,browserPaintTime:40,animationTimeout:null,browserPaintTimeout:null,currentView:null,previousView:null,currentFilter:{},events:{changeCategory:"changeCategory",changeDepartment:"changeDepartment",showDepartmentsList:"renderDepartmentsList",showCurrentCategoryDepartment:"showCurrentCategoryDepartment",animateBack:"animateBack",animateForward:"animateForward"},initialize:function(a){return this.userNavigation=a.userNavigation,this.model=a.model,this.dispatcher=a.dispatcher,this.headerType=a.headerType,this.contentContainer=this.$el.siblings(".main-wrapper"),this.html=this.$el.parents("html"),this.categoriesCollection=a.categoriesCollection,this.departmentsCollection=a.departmentsCollection,this.uniqueCMId=a.uniqueCMId,this.listenTo(this.dispatcher,"setSideNavVisibility",this.toggleSideNavVisibility),this.initAnimateClasses(),this.render(),this.html.hasClass("touch")&&this.attachTouchEvents(),"simple-header"===this.headerType?void this.html.addClass(this.headerType):(this.$el.addClass("overthrow"),this.initListeners(),void this.initSearchListeners())},attachTouchEvents:function(){d(this.el,{drag_min_distance:1,drag_block_horizontal:!0}).on("swipeleft",a.proxy(this.closeSideNav,this))},initListeners:function(){this.listenTo(this.categoriesCollection,"currentCategorySet",this.renderCategoryNavigationTab),this.listenTo(this.categoriesCollection,"categoryFetchError",this.renderDepartmentsList),this.listenTo(this.departmentsCollection,"currentDepartmentSet",this.renderDepartmentNavigationTab)},initSearchListeners:function(){this.listenTo(this.dispatcher,"searchFilter",this.storeSearchFilter),this.listenToOnce(this.dispatcher,"setSideNavVisibility",this.handleSearchFilter)},storeSearchFilter:function(a){this.currentFilter=a},showLoader:function(){this.$el.prepend('<div class="loader"></div>')},hideLoader:function(){this.$(".loader").remove()},handleSearchFilter:function(){switch(this.showLoader(),this.currentFilter.type){case"department":this.changeDepartment(this.currentFilter.name);break;case"category":this.changeCategory(this.currentFilter.name);break;default:this.renderDepartmentsList()}},initAnimateClasses:function(){this.$el.addClass("slide-out-navigation"),this.contentContainer.toggleClass("slide-out-navigation")},toggleSideNavVisibility:function(){this.$el.toggleClass("slide-in-navigation"),this.html.toggleClass("side-nav-active"),this.contentContainer.toggleClass("slide-in-navigation")},animateBack:function(){this.animationDirection="slide-from-left"},animateForward:function(){this.animationDirection="slide-from-right"},closeSideNav:function(){this.dispatcher.trigger("toggleSideNavVisibility"),this.sendEventForCookieMonster(this.uniqueCMId,"SideNavigation","swipe_hide"),this.toggleSideNavVisibility()},changeCategory:function(a,b){"undefined"==typeof b&&(b=a),this.categoriesCollection.setCurrentCategory(b)},changeDepartment:function(a,b){"undefined"==typeof b&&(b=a),this.departmentsCollection.setCurrentDepartment(b)},showCurrentCategoryDepartment:function(a,b){this.departmentsCollection.setDepartmentByCategoryId(b)},hidePreviousTabs:function(a){var b=0;for(b;a-1>b;b++)this.$(".navigation-tab").eq(b).removeClass("current")},animateTab:function(){var b=this.$(".navigation-tab").length;return b>1?(this.hidePreviousTabs(b),this.$(".navigation-tab").eq(b-1).addClass("current slide-in"),clearTimeout(this.animationTimeout),void(this.animationTimeout=setTimeout(a.proxy(this.removePreviousTab,this),this.animationDuration))):void this.$(".navigation-tab").eq(0).addClass("current")},removePreviousTab:function(){this.previousView.remove&&(this.previousView.trigger("close"),this.previousView.close())},delayTabAnimation:function(){clearTimeout(this.browserPaintTimeout),this.browserPaintTimeout=setTimeout(a.proxy(this.animateTab,this),this.browserPaintTime)},setPreviousView:function(){this.previousView=this.currentView},renderDepartmentsList:function(){return this.hideLoader(),this.departmentsCollection.isDepartmentsListInCache()?(this.setPreviousView(),this.currentView=new f({departmentsCollection:this.departmentsCollection,animationDirection:this.animationDirection}),this.navigationTabsContainer.append(this.currentView.render().el),this.delayTabAnimation(),this):(this.listenTo(this.departmentsCollection,"sync",this.renderDepartmentsList),void this.departmentsCollection.getDepartmentsList())},renderDepartmentNavigationTab:function(){return this.hideLoader(),this.setPreviousView(),this.currentView=new h({currentDepartment:this.departmentsCollection.currentDepartment,animationDirection:this.animationDirection}),this.navigationTabsContainer.append(this.currentView.render().el),this.delayTabAnimation(),this},renderCategoryNavigationTab:function(){return this.hideLoader(),this.setPreviousView(),this.currentView=new g({currentCategory:this.categoriesCollection.currentCategory,categoriesList:this.categoriesCollection.currentCategorySubCategories,animationDirection:this.animationDirection}),this.navigationTabsContainer.append(this.currentView.render().el),this.delayTabAnimation(),this},render:function(){return this.$el.append(i),this.userNavigationContainer=this.$el.find(".user-nav-container"),this.navigationTabsContainer=this.$el.find(".navigation-tabs"),this.userNavigationContainer.append(this.userNavigation),this}});return j}),define("tpl!navigation/templates/my-account-mobile-node-template.html",function(){return function(obj){var __p=[];with(obj||{})__p.push(""),link?__p.push('    <a href="',link,'">',name,"</a>"):__p.push("    <span>",name,"</span>"),__p.push(""),fields&&__p.push('    <i class="sprite icon-arrow arrow-right"></i>'),__p.push("");return __p.join("")}}),define("navigation/views/MenuNodeView",["jquery","underscore","backbone","tpl!navigation/templates/my-account-mobile-node-template.html"],function(a,b,c,d){"use strict";var e=c.View.extend({tagName:"li",render:function(){return this.$el.html(d(this.model.toJSON())),this}});return e}),define("tpl!navigation/templates/my-account-mobile-template.html",function(){return function(obj){var __p=[];with(obj||{})__p.push('<ul class="my-account-menu navigation-tabs"></ul>');return __p.join("")}}),define("navigation/views/MenuChildrenView",["jquery","underscore","backbone","navigation/views/MenuNodeView","tpl!navigation/templates/my-account-mobile-node-template.html","tpl!navigation/templates/my-account-mobile-template.html"],function(a,b,c,d,e,f){"use strict";var g=c.View.extend({tagName:"li",className:"menu-items",render:function(){var b=a(f());return this.model.get("fields")&&this.model.get("fields").each(function(a){var c=new d({model:a}),e=new g({model:a});b.append(c.render().el),b.append(e.render().el)},this),this.$el.append(b),this}});return g}),define("navigation/views/MyAccountMobileView",["jquery","underscore","backbone","navigation/views/MenuNodeView","navigation/views/MenuChildrenView","tpl!navigation/templates/my-account-mobile-template.html"],function(a,b,c,d,e,f){"use strict";return c.View.extend({initialize:function(){this.model.on("menuReady",this.drawMyAccountMenu,this)},events:{"click .my-account-menu li:not(.menu-items)":"myAccountMenuClickGoRight","click li.current-my-account":"myAccountMenuClickGoLeft"},drawMyAccountMenu:function(){var b=a(f()),c=this.model.get("menuNodes");c.each(function(a){var c=new d({model:a});b.append(c.render().el);var f=new e({model:a});b.append(f.render().el)},this),this.$(".ma-layer:eq(0)").hide().before(b),this.$(".my-account-menu:eq(0) li:eq(0)").addClass("start-my-account-menu slide")},myAccountMenuClickGoRight:function(b){var c=a(b.target),d=c.parent("li"),e=d.children("a"),f=d.next("li.menu-items"),g=f.children("ul").children("li:not(.menu-items)"),h=d.hasClass("start-my-account-menu");return e.length?void 0:(this.$(".my-account-menu li").removeClass("current-my-account slide"),h&&this.$(".departments-tab, .category-tab, .departments-list, .user-nav > li").addClass("flag-hide"),d.addClass("current-my-account slide"),f.addClass("slide").parents("li.menu-items").addClass("slide"),g.addClass("slide"),!1)},myAccountMenuClickGoLeft:function(b){var c=a(b.target),d=c.parent("li"),e=d.siblings(".menu-items"),f=d.parent().children("li").not(".menu-items"),g=d.parentsUntil(".menu-items").parent().prev(),h=d.hasClass("start-my-account-menu");return h&&this.$(".departments-tab, .category-tab, .departments-list, .user-nav > li").removeClass("flag-hide"),d.removeClass("current-my-account"),e.removeClass("slide"),f.addClass("slide"),g.addClass("slide"),h||g.addClass("current-my-account slide"),!1}})}),define("navigation/models/MyAccountModel",["backbone","underscore"],function(a,b){"use strict";return a.Model.extend({defaults:{myAccountTabMenuActive:null,myAccountTabMenuHistory:null,menuNodes:null,menuReady:!1,document:null,window:null},initialize:function(){this.get("menuNodes").on("sync",this.onSync,this)},onSync:function(){this.hashChanged(),this.get("window").onhashchange=b.bind(this.hashChanged,this),this.setActiveTab(),this.trigger("menuReady"),this.set("menuReady",!0)},hashChanged:function(){this.setActiveItem(this.get("document").location.pathname+this.get("document").location.hash)},findActiveElement:function(){var a=this.get("menuNodes").at(0).get("fields").where({active:!0});return a.length>0?a[0].cid:this.get("menuNodes").at(0).get("fields").at(0).cid},setActiveTab:function(){var a=this.findActiveElement();this.set("myAccountTabMenuHistory",a),this.set("myAccountTabMenuActive",a)},setActiveItem:function(a){this.get("menuNodes").each(function(b){b.setActiveItem(a)})}})}),define("navigation/models/CategoryModel",["backbone"],function(a){"use strict";var b=a.Model.extend({initialize:function(){this.set("id",this.get("categoryId"))}});return b}),define("navigation/collections/CategoriesCollection",["backbone","underscore","jquery","navigation/models/CategoryModel"],function(a,b,c,d){"use strict";return a.Collection.extend({categoryId:null,currentCategory:null,activeLeaf:null,currentCategorySubCategories:[],baseUrl:"",model:d,categoryFetchError:!1,initialize:function(a){this.baseUrl=a.baseUrl,this.listenTo(this,"sync",this.setCurrentCategoryOnSync)},url:function(){return this.baseUrl.replace("{categoryId}",this.currentCategoryId)},fetchCurrentCategory:function(){this.fetch({remove:!1})},parse:function(a){var b=1;if(a.length<1)return this.categoryFetchError=!0,this.trigger("categoryFetchError"),a;for(b;b<a.length;b++)a[b].position=b;return a},setCurrentCategoryOnSync:function(){this.setCurrentCategory(this.currentCategoryId)},setCurrentLeaf:function(a){return null===this.activeLeaf?void this.setLeafAsActive(a):(this.activeLeaf.set("active",!1),void this.setLeafAsActive(a))},setLeafAsActive:function(a){this.activeLeaf=a,this.activeLeaf.set("active",!0)},setCurrentCategory:function(a){this.currentCategoryId=parseInt(a,10);var b=this.findWhere({categoryId:this.currentCategoryId}),c=this.where({parentId:this.currentCategoryId});return void 0===b?this.categoryFetchError?void(this.categoryFetchError=!1):void this.fetchCurrentCategory():c.length<1?b.get("leaf")?(this.setCurrentLeaf(b),void this.setCurrentCategory(b.get("parentId"))):void this.fetchCurrentCategory():(this.currentCategory=b,this.currentCategorySubCategories=c,void this.trigger("currentCategorySet"))}})}),define("navigation/collections/DepartmentsCollection",["backbone"],function(a){"use strict";return a.Collection.extend({url:"",currentDepartment:null,currentDepartmentName:null,inSync:!1,initialize:function(a){this.url=a.url,this.listenTo(this,"sync",this.setCacheFlag)},setCacheFlag:function(){this.inSync=!0},isDepartmentsListInCache:function(){return this.inSync},getDepartmentsList:function(){this.fetch()},setCurrentDepartmentAsync:function(){this.setCurrentDepartment(this.currentDepartmentName)},setCurrentDepartment:function(a){return this.isDepartmentsListInCache()?(this.currentDepartment=this.findWhere({name:a}),void this.trigger("currentDepartmentSet")):(this.currentDepartmentName=a,this.listenTo(this,"sync",this.setCurrentDepartmentAsync),void this.getDepartmentsList())},setDepartmentByCategoryIdAsync:function(){this.setDepartmentByCategoryId(this.departmentCategoryId)},setDepartmentByCategoryId:function(a){var b,c;if(!this.isDepartmentsListInCache())return this.departmentCategoryId=a,this.listenTo(this,"sync",this.setDepartmentByCategoryIdAsync),void this.getDepartmentsList();for(c=0;c<this.length;c++){var d=this.at(c),e=d.get("categories");for(b=0;b<e.length;b++)if(e[b].categoryId===a)return this.currentDepartment=d,void this.trigger("currentDepartmentSet")}}})}),define("navigation/models/MenuNodeModel",["backbone","underscore"],function(a,b){"use strict";var c=a.Model.extend({defaults:{name:"",link:"","class":"",fields:null},setActiveItem:function(a){var c=this.get("link"),d=!1,e=this.get("fields");return this.set("active",!1),!b.isEmpty(e)&&e.length>0&&(d=b.reduce(e.map(function(b){return b.setActiveItem(a)}),function(a,b){return a||b})),this.uriMatch(c,a)||d?(this.set("active",!0),!0):d},uriMatch:function(a,b){return a.length>0&&0===b.indexOf(a)}});return c}),function(a,b){"function"==typeof define&&define.amd?define("backbone-fetch-cache",["underscore","backbone","jquery"],function(c,d,e){return a.Backbone=b(c,d,e)}):"undefined"!=typeof exports?module.exports=b(require("underscore"),require("backbone"),require("jquery")):a.Backbone=b(a._,a.Backbone,a.jQuery)}(this,function(a,b,c){function d(b,d){var e;return(e=d&&d.url?d.url:a.isFunction(b.url)?b.url():b.url)?d&&d.data?"string"==typeof d.data?e+"?"+d.data:e+"?"+c.param(d.data):e:void 0}function e(a,c,d){c=c||{};var e=b.fetchCache.getCacheKey(a,c),f=!1,g=!1;e&&c.cache!==!1&&(c.cache||c.prefill)&&(c.expires!==!1&&(f=(new Date).getTime()+1e3*(c.expires||300)),c.prefillExpires!==!1&&(g=(new Date).getTime()+1e3*(c.prefillExpires||300)),b.fetchCache._cache[e]={expires:f,prefillExpires:g,value:d},b.fetchCache.setLocalStorage())}function f(c){a.isFunction(c)&&(c=c()),delete b.fetchCache._cache[c],b.fetchCache.setLocalStorage()}function g(){if(k&&b.fetchCache.localStorage)try{localStorage.setItem(b.fetchCache.getLocalStorageKey(),JSON.stringify(b.fetchCache._cache))}catch(a){var c=a.code||a.number||a.message;if(22!==c&&1014!==c)throw a;this._deleteCacheWithPriority()}}function h(){if(k&&b.fetchCache.localStorage){var a=localStorage.getItem(b.fetchCache.getLocalStorageKey())||"{}";b.fetchCache._cache=JSON.parse(a)}}function i(a){return window.setTimeout(a,0)}var j={modelFetch:b.Model.prototype.fetch,modelSync:b.Model.prototype.sync,collectionFetch:b.Collection.prototype.fetch},k=function(){var a="undefined"!=typeof window.localStorage;if(a)try{localStorage.setItem("test_support","test_support"),localStorage.removeItem("test_support")}catch(b){a=!1}return a}();return b.fetchCache=b.fetchCache||{},b.fetchCache._cache=b.fetchCache._cache||{},b.fetchCache.enabled=!0,b.fetchCache.priorityFn=function(a,b){return a&&a.expires&&b&&b.expires?a.expires-b.expires:a},b.fetchCache._prioritize=function(){var b=a.values(this._cache).sort(this.priorityFn),c=a.indexOf(a.values(this._cache),b[0]);return a.keys(this._cache)[c]},b.fetchCache._deleteCacheWithPriority=function(){b.fetchCache._cache[this._prioritize()]=null,delete b.fetchCache._cache[this._prioritize()],b.fetchCache.setLocalStorage()},b.fetchCache.getLocalStorageKey=function(){return"backboneCache"},"undefined"==typeof b.fetchCache.localStorage&&(b.fetchCache.localStorage=!0),b.Model.prototype.fetch=function(d){function e(){return d.prefill&&(!d.prefillExpires||l)}function f(){d.parse&&(m=o.parse(m,d)),o.set(m,d),a.isFunction(d.prefillSuccess)&&d.prefillSuccess(o,m,d),o.trigger("cachesync",o,m,d),o.trigger("sync",o,m,d),e()?n.notify(o):(a.isFunction(d.success)&&d.success(o,m,d),n.resolve(o))}if(!b.fetchCache.enabled)return j.modelFetch.apply(this,arguments);d=a.defaults(d||{},{parse:!0});var g=b.fetchCache.getCacheKey(this,d),h=b.fetchCache._cache[g],k=!1,l=!1,m=!1,n=new c.Deferred,o=this;if(h&&(k=h.expires,k=k&&h.expires<(new Date).getTime(),l=h.prefillExpires,l=l&&h.prefillExpires<(new Date).getTime(),m=h.value),!k&&(d.cache||d.prefill)&&m&&(null==d.async&&(d.async=!0),d.async?i(f):f(),!e()))return n;var p=j.modelFetch.apply(this,arguments);return p.done(a.bind(n.resolve,this,this)).done(a.bind(b.fetchCache.setCache,null,this,d)).fail(a.bind(n.reject,this,this)),n.abort=p.abort,n},b.Model.prototype.sync=function(a,c,d){if("read"===a||!b.fetchCache.enabled)return j.modelSync.apply(this,arguments);var e,g,h=c.collection,i=[];for(i.push(b.fetchCache.getCacheKey(c,d)),h&&i.push(b.fetchCache.getCacheKey(h)),e=0,g=i.length;g>e;e++)f(i[e]);return j.modelSync.apply(this,arguments)},b.Collection.prototype.fetch=function(d){function e(){return d.prefill&&(!d.prefillExpires||l)}function f(){o[d.reset?"reset":"set"](m,d),a.isFunction(d.prefillSuccess)&&d.prefillSuccess(o),o.trigger("cachesync",o,m,d),o.trigger("sync",o,m,d),e()?n.notify(o):(a.isFunction(d.success)&&d.success(o,m,d),n.resolve(o))}if(!b.fetchCache.enabled)return j.collectionFetch.apply(this,arguments);d=a.defaults(d||{},{parse:!0});var g=b.fetchCache.getCacheKey(this,d),h=b.fetchCache._cache[g],k=!1,l=!1,m=!1,n=new c.Deferred,o=this;if(h&&(k=h.expires,k=k&&h.expires<(new Date).getTime(),l=h.prefillExpires,l=l&&h.prefillExpires<(new Date).getTime(),m=h.value),!k&&(d.cache||d.prefill)&&m&&(null==d.async&&(d.async=!0),d.async?i(f):f(),!e()))return n;var p=j.collectionFetch.apply(this,arguments);return p.done(a.bind(n.resolve,this,this)).done(a.bind(b.fetchCache.setCache,null,this,d)).fail(a.bind(n.reject,this,this)),n.abort=p.abort,n},h(),b.fetchCache._superMethods=j,b.fetchCache.setCache=e,b.fetchCache.getCacheKey=d,b.fetchCache.clearItem=f,b.fetchCache.setLocalStorage=g,b.fetchCache.getLocalStorage=h,b}),define("navigation/collections/MenuNodeCollection",["backbone","underscore","navigation/models/MenuNodeModel","backbone-fetch-cache"],function(a,b,c){"use strict";var d=a.Collection.extend({url:"/myaccount/index.php/getMenu",model:function(a,e){var f=b.extend({},a);return f.fields&&(f.fields=new d(f.fields)),new c(f,e)}});return d}),define("navigation/views/SideNavigationToggleView",["backbone","underscore","navigation/views/NavigationAbstractView"],function(a,b,c){"use strict";var d=c.extend({active:!1,events:{click:"setSideNavVisibility"},initialize:function(a){this.dispatcher=a.dispatcher,this.uniqueCMId=a.uniqueCMId,this.isToggleVisible(),this.listenTo(this.dispatcher,"toggleSideNavVisibility",this.toggleSideNavClass)},isToggleVisible:function(){"undefined"!=typeof window.matchMedia&&window.matchMedia("(max-width: 920px)").matches&&this.sendEventForCookieMonster(this.uniqueCMId,"SideNavigation","toggle_visible")},toggleSideNavClass:function(){this.$el.toggleClass("active")},setSideNavVisibility:function(){this.active=this.active?!1:!0,this.sendEventForCookieMonster(this.uniqueCMId,"SideNavigation","toggle_click",this.active),this.toggleSideNavClass(),this.dispatcher.trigger("setSideNavVisibility",this.active)}});return d}),define("navigation/models/TriggerModel",["backbone","underscore"],function(a,b,c){"use strict";return a.Model.extend({initialize:function(a){if(null!==a.loginData.userIdentity)if(a.maMenuContainer.length>0)this.triggerFetch(a.menuNodes);else{var c=b.once(b.bind(this.triggerFetch,this,a.menuNodes));a.dispatcher.on("setSideNavVisibility",function(a){a&&c()})}},triggerFetch:function(a){a.fetch({cache:!0,expires:6e4})}})}),define("navigation/main",["backbone","jquery","underscore","navigation/views/SideNavigationView","navigation/views/MyAccountMobileView","navigation/models/MyAccountModel","navigation/collections/CategoriesCollection","navigation/collections/DepartmentsCollection","navigation/collections/MenuNodeCollection","navigation/views/SideNavigationToggleView","navigation/models/TriggerModel","require","velalayout/GetUserLoginData"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";return function(a){var c,n,o,p,q,r,s,t,u=b(".main-header-wrapper"),v=b(".user-links-wrapper").eq(0).clone(),w=v.find(".user-nav"),x=parseInt(16777216*(1+Math.random()),10),y=b(".my-account-desktop-left-menu");q=new g({baseUrl:w.data("categoryListRoute")}),r=new h({url:w.data("departmentsListRoute")}),c=new d({el:".side-nav",userNavigation:v,dispatcher:a.dispatcher,headerType:u.data("headerType"),categoriesCollection:q,departmentsCollection:r,uniqueCMId:x}),s=new i,o=new f({menuNodes:s,window:window,document:document}),t=new k({maMenuContainer:y,menuNodes:s,dispatcher:a.dispatcher,loginData:new m}),p=new j({el:".navigation-toggle",dispatcher:a.dispatcher,uniqueCMId:x}),n=new e({el:".side-nav",model:o}),y.length>0&&l(["navi-desktop-menu"],function(a){a(o)})}}),define("splashscreen/mobile-splash/MobileSplashView",["jquery","backbone","jquery.cookie"],function(a,b){"use strict";var c=b.View.extend({deviceData:{},deviceName:"",eventCat:"mobileSplash",events:{"click .close":"closeSplash","click .button, .smartphone":"downloadApp","click .footer a":"watchVideo"},initialize:function(a){this.template=a.template,this.devicesData=this.$el.data("devices")},show:function(){this.shouldSkip()||a.cookie("mobileSplash")||(a.cookie("mobileSplash",1,{expires:7,path:"/"}),this.detectDevice(),""!==this.deviceName&&this.render())},downloadApp:function(){this.sendEventForCookieMonster("downloadApp")},watchVideo:function(){this.sendEventForCookieMonster("watchVideo")},sendEventForCookieMonster:function(a){var b={cat:this.eventCat,a:a};try{window.cm.event(b)}catch(c){window.console.info("Fail to log cookie monster "+b.cat+" event.")}},detectDevice:function(){/Android/i.test(navigator.userAgent)?(this.deviceData=this.devicesData.android,this.deviceName="android"):/IEMobile/i.test(navigator.userAgent)?(this.deviceData=this.devicesData.windows,this.deviceName="windows"):/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(this.deviceData=this.devicesData.apple,this.deviceName="apple"),this.deviceData.smartphoneImg=this.$el.data(this.deviceName)},shouldSkip:function(){return/registration/.test(window.location.href)},closeSplash:function(){this.$el.addClass("hidden"),this.sendEventForCookieMonster("close")},render:function(){return this.$el.html(this.template(this.deviceData)),this.$el.removeClass("hidden"),this}});return c}),define("splashscreen/main",["splashscreen/mobile-splash/MobileSplashView","jquery","underscore"],function(a,b,c){"use strict";return function(){var d,e=b(".mobile-splash-container");e.length&&(d=new a({el:e,template:c.template(b("#mobile-splash-template").html())}),d.show())}}),function(a,b){"use strict";"function"==typeof define&&define.amd?define("splashscreen/InstallmentsBanner",["cookies-interface-js"],function(c){return a.installmentsBanner=b(c)}):a.installmentsBanner=b(window.cookiesInterface)}(this,function(a){"use strict";function b(a,b){return"function"==typeof a?function(){return a.apply(b,arguments)}:void 0}var c=new a,d=function(a){this.options=a,this.baseElement=document.getElementById(this.options.baseElementId),this.closeElement=document.getElementById(this.options.closeElementId),this.storageName="installmentsBannerHide",this.expireDate=this.options.expireDate?this.options.expireDate:365,this.render()};return d.prototype.render=function(){c.get(this.storageName)||(this.baseElement.className="enabled",this.attachListeners())},d.prototype.hideBanner=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1,this.baseElement.className="",c.set(this.storageName,1,this.expireDate)},d.prototype.attachListeners=function(){return document.addEventListener?void this.closeElement.addEventListener("click",b(this.hideBanner,this),!1):void this.closeElement.attachEvent("onclick",b(this.hideBanner,this))},d}),define("velalayout/pagesMain",["velalayout/openHelp","search/app","departments/navigationBar/main","velalayout/GetUserLoginData","velalayout/cartStatus/main","velalayout/login-tip","cookiepolicy/main","navigation/main","splashscreen/main","splashscreen/InstallmentsBanner","json","jquery","backbone","underscore","jquery.cookie"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";return function(k){void 0===k&&(k={});var o=n.defaults(k,{dispatcher:n.clone(m.Events)}),p=new d;p.initialize(),a.initialize();var q,r=(new h({dispatcher:o.dispatcher}),new b({dispatcher:o.dispatcher}),l(".main-header + .main-nav"));r.length&&(q=new c({el:".main-header + .main-nav",urlRoot:r.data("url-root"),openLayerDelay:300,closeLayerDelay:400})),l("#cart-status-wrapper").length&&e.initialize({el:"#cart-status-wrapper",previewUrl:"/Cart.php/getCartDataJson",addUrl:"/Cart.php/addAjax"}),f();var s,t=l("#cookie-policy-banner-config").data("config");if(t&&(s=new g({storageName:"policyBannerHide",policyPageUrl:t.url,langs:t.langs})),i(),l("#installments-banner-container").length){new j({baseElementId:"installments-banner-container",closeElementId:"installments-banner-close"})}}});